<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kerttervező</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/sql-wasm.js"></script>
    <link rel="icon" type="image/x-icon" href="\novenyek/favicon.png">
</head>
<body>
    <div id="top">
        <h3 id="oldalnev">Kerttervező</h3>
    </div>
    <div id="kozep">
        <div>
            <h1 id="cim1">Parcella</h1>
            <form action="" id="form1">
                <label for="mennyiseg">A parcellák száma (darab)</label>
                <input type="number" id="mennyiseg" name="mennyiseg" min="1" max="16" value="1">
                <br>
               <button onclick="kuldes()">Tovább</button>
            </form>
        </div>
        
    </div>
    
 <!--h1>Növények listája</h1>
    <ul id="plant-list"></ul>
    <form id="plant-form">
        <input type="text" id="plant-name" placeholder="Növény neve" required>
        <input type="text" id="plant-type" placeholder="Típus" required>
        <button type="submit">Hozzáadás</button>
    </form>
    <script src="script.js"></script>-->

    <script>

        class Noveny {
            constructor(id, magyar, latin, sor_tav, to_tav, kep) {
                this.id = id;
                this.magyar = magyar;
                this.latin = latin;
                this.sor_tav = sor_tav;
                this.to_tav = to_tav;
                this.kep = kep;

            }
        }
        class Kapcsolat {
            constructor(noveny1_id, noveny2_id, kapcsolatuk) {
                this.noveny1_id = noveny1_id;
                this.noveny2_id = noveny2_id;
                this.kapcsolatuk = kapcsolatuk;
            }
        }
        class Fajta {
            constructor(id, nev, noveny_id) {
                this.id = id;
                this.nev = nev;
                this.noveny_id = noveny_id;
  
            }
        }
        /*const sqlite = require('sqlite3').verbose();

        const db = new sqlite3.Database('./kerttervezo.db', (err) => {
            if (err) {
                console.error('Hiba az adatbázis csatlakozásnál:', err.message);
            } else {
                console.log('Sikeresen csatlakoztál az SQLite adatbázishoz!');
            }
        });*/

        async function loadDatabase() {
            // SQLite.js betöltése
            const SQL = await initSqlJs({ locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/${file}` });

            // Adatbázis fájl betöltése
            const response = await fetch("kerttervezo.db");
            const buffer = await response.arrayBuffer();
            const db = new SQL.Database(new Uint8Array(buffer));

            //Növények tábla listája + a táblázat
            const results = db.exec("SELECT id, magyar_nev, latin_nev, sor_tav, to_tav, kep FROM novenyek");
            
            let table = document.getElementById("novenyekTable");

            let novenyekLista = [];

            results[0].values.forEach(row => {
                let tr = document.createElement("tr");
                tr.innerHTML = `<td><img src="${row[5]}"></td><td>${row[1]}</td><td>${row[2]}</td><td>${row[3]}cm</td><td>${row[4]}cm</td><td><input type="number" id="mennyiseg" name="mennyiseg" min="1" max="100" value="0"></td>`;
                table.appendChild(tr);

                let noveny = new Noveny(row[0], row[1], row[2], row[3], row[4], row[5]);
                novenyekLista.push(noveny);
            });
            console.log(novenyekLista[1].latin)


            //Kapcsolat táblának a listája
            const results2 = db.exec("SELECT noveny1_id, noveny2_id, kapcsolatuk FROM kapcsolat");

            let kapcsolatLista = [];

            results2[0].values.forEach(row => {

                let kapcs = new Kapcsolat(row[0], row[1], row[2]);
                kapcsolatLista.push(kapcs);
            });
            console.log(kapcsolatLista[1].kapcsolatuk)


            //Fajta táblának a listája
            const results3 = db.exec("SELECT id, nev, novenyek_id FROM fajta");

            let fajtaLista = [];

            results3[0].values.forEach(row => {

                let faj = new Fajta(row[0], row[1], row[2]);
                fajtaLista.push(faj);
            });
            console.log(fajtaLista[1].nev)


        }

        loadDatabase();

        
        function kuldes(){
            let mennyiseg = document.getElementById('mennyiseg').value;
            console.log(mennyiseg); 
            let div1 = document.getElementById("kozep");
            if(mennyiseg.length == 0){
                alert("Nem adott meg mennyiséget!");
            }
            else if(mennyiseg > 16){alert("Túl nagy a a megadott parcellák száma!");}
            else{
                div1.remove();
                let div2 = document.createElement("div");
                let h1 = document.createElement("h1");
                h1.innerHTML = "Parcella nagyága"
                div2.id = "kozep2";
                let div3 = document.createElement("div");
                let form1 = document.createElement("form");
                form1.action = "";
                form1.id = "form1";
                let label1 = document.createElement("label");
                label1.for = "hossz";

                label1.textContent = "A parcella hossza (méter)  ";
                let input1 = document.createElement("input");
                input1.type = "number";
                input1.min = "1";
                input1.max = "20";
                input1.name = "hossz";
                input1.id = "hossz";

                let br = document.createElement("br");
                let br2 = document.createElement("br")
                
                let label2 = document.createElement("label");
                label2.for = "szélesség";
                label2.textContent = "A parcella szélessége (méter)  ";
                let input2 = document.createElement("input");
                input2.type = "number";
                input2.min = "1";
                input2.max = "20";
                input2.name = "szelesseg";
                input2.id = "szelesseg";

                let kuldes2 = document.createElement("button")
                kuldes2.id = "kuldes2"; 
                kuldes2.textContent = "Tovább"
                kuldes2.type = "submit";
                

                form1.appendChild(label1);
                form1.appendChild(input1);
                form1.appendChild(br);
                form1.appendChild(label2);
                form1.appendChild(input2);
                form1.appendChild(br2);
                form1.appendChild(kuldes2);
                div3.appendChild(h1)
                div3.appendChild(form1);
                div2.appendChild(div3);
                document.body.appendChild(div2);
                

                kuldes2.addEventListener("click", function (event){
                    event.preventDefault();
                    if(parseInt(input1.value) > 20){
                        alert("Túl nagy parcella hosszt adott meg!")
                    }
                    else if(parseInt(input1.value) > 20){
                        alert("Túl nagy parcella szélességet adott meg!")
                    }
                    else if(input1.value.length === 0){
                        alert("Nem adott meg parcella hosszt!")
                    }
                    else if(input2.value.length === 0){
                        alert("Nem adott meg parcella szélességet!")
                    }
                    else{
                        div2.remove();




                        
                    }
                })
            }
        }
        
       
    </script>






    <div id="footer">
        <p>© 2025</p>
    </div>


</body>
</html>
